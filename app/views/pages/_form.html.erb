<% thepage ||= form %>

<%= error_messages_for :page, :object => thepage %>

<% form_for(thepage, :builder => NormalFormBuilder) do |f| %>
  <% accordion do %>

    <% accordion_item "General" do %>
      <%= f.text_field :title %>
      <%= f.text_field :url %>
    <% end %>

    <% accordion_item "Hierarchy" do %>
      <%= f.collection_select :wanted_parent_id, Page.all_except(thepage), :id, :title, :label => 'Parent Page', :include_blank => true  %>
    <% end %>


    <% accordion_item "Layout" do %>
      <%= f.collection_select :layout_id, Grid.roots, :id, :label, {:include_blank => (f.object.root? ? false : 'from parent Page'), :label => 'Layout'}  %>
      <%= new_page_layout_link f.object,  :label => "Create a new layout" %>
      <%= f.select :yui, Page::Types.invert, :label => 'Width' %>
    <% end %>

  <% end %>

  <% links do %>
    <%= f.submit %>
  <% end %>
<% end %>
